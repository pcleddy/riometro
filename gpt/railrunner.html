<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rail Runner – Next Train Finder</title>
  <style>
    :root { --bg:#0b0f14; --card:#121823; --muted:#9fb0c3; --text:#e7eef7; --accent:#ffb100; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background:var(--bg); color:var(--text); }
    .wrap { max-width: 980px; margin: 0 auto; padding: 20px; }
    h1 { font-size: 22px; margin: 0 0 12px; }
    .sub { color: var(--muted); margin-bottom: 18px; }
    .grid { display:grid; grid-template-columns: repeat(12, 1fr); gap: 12px; }
    .card { background: var(--card); border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 14px; }
    .row { grid-column: span 12; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    .col-3 { grid-column: span 3; }
    label { display:block; font-size: 12px; color: var(--muted); margin-bottom: 6px; }
    select, input { width:100%; box-sizing:border-box; padding: 10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.04); color: var(--text); }
    .btn { cursor:pointer; padding: 10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.06); color: var(--text); }
    .btn.primary { background: rgba(255,177,0,0.12); border-color: rgba(255,177,0,0.35); }
    .btn:active { transform: translateY(1px); }
    .pill { display:inline-block; font-size: 12px; padding: 4px 8px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.12); color: var(--muted); }
    .pill.accent { border-color: rgba(255,177,0,0.5); color: var(--accent); }
    .big { font-size: 26px; font-weight: 700; margin: 8px 0 2px; }
    .muted { color: var(--muted); }
    table { width:100%; border-collapse: collapse; margin-top: 10px; }
    th, td { text-align:left; padding: 10px 8px; border-bottom: 1px solid rgba(255,255,255,0.08); font-size: 14px; }
    th { color: var(--muted); font-weight: 600; font-size: 12px; letter-spacing: 0.04em; text-transform: uppercase; }
    .warn { color:#ffcf70; }
    .err { color:#ff7a7a; }
    .topbar { display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
    .tiny { font-size: 12px; }
    @media (max-width: 800px) {
      .col-6, .col-4, .col-3 { grid-column: span 12; }
    }
  </style>
</head>
<body>
  <div id="app" class="wrap">
    <div class="topbar">
      <div>
        <h1>Rail Runner – Next Train Finder</h1>
        <div class="sub">
          Pick your station + direction. This finds the next departure using the embedded schedule JSON.
        </div>
      </div>
      <div class="pill accent tiny">Client-side • No backend</div>
    </div>

    <div class="grid">
      <div class="card col-4">
        <label>Service day</label>
        <select v-model="dayMode">
          <option value="auto">Auto (today)</option>
          <option value="weekday">Weekday</option>
          <option value="saturday">Saturday</option>
          <option value="sunday">Sunday</option>
        </select>
        <div style="margin-top:10px; display:flex; gap:10px; align-items:center;">
          <input id="isFriday" type="checkbox" v-model="isFriday" style="width:auto;" />
          <label for="isFriday" style="margin:0; cursor:pointer;">Treat today as Friday (include Friday-only)</label>
        </div>
      </div>

      <div class="card col-4">
        <label>Direction</label>
        <select v-model="direction">
          <option value="northbound">Northbound</option>
          <option value="southbound">Southbound</option>
        </select>
        <div class="muted tiny" style="margin-top:8px;">
          Northbound: Belen → Santa Fe • Southbound: Santa Fe → Belen
        </div>
      </div>

      <div class="card col-4">
        <label>Station</label>
        <select v-model="station">
          <option v-for="s in stations" :key="s" :value="s">{{ s }}</option>
        </select>
        <div class="muted tiny" style="margin-top:8px;">
          Times shown are departures/arrivals as listed in schedule.
        </div>
      </div>

      <div class="card col-6">
        <label>Current time (local)</label>
        <input type="time" v-model="timeHHMM" step="60" />
        <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn primary" @click="setNow">Use now</button>
          <button class="btn" @click="timeHHMM = '07:00'">07:00</button>
          <button class="btn" @click="timeHHMM = '12:00'">12:00</button>
          <button class="btn" @click="timeHHMM = '17:00'">17:00</button>
        </div>
        <div class="muted tiny" style="margin-top:10px;">
          Auto-day uses your browser day-of-week.
        </div>
      </div>

      <div class="card col-6">
        <div class="pill">{{ activeDayLabel }}</div>
        <div class="pill" style="margin-left:8px;">{{ directionLabel }}</div>
        <div class="big" v-if="nextTrain">
          Next: {{ nextTrain.train }}
          <span class="pill accent" style="margin-left:10px;" v-if="nextTrain.type === 'express'">Express</span>
          <span class="pill" style="margin-left:10px;" v-if="nextTrain.type === 'friday_only'">Friday-only</span>
        </div>
        <div class="big err" v-else>No upcoming trains found</div>
        <div class="muted" v-if="nextTrain">
          {{ station }} at <b>{{ nextTrain.time }}</b>
          <span class="muted"> • in {{ minutesUntil(nextTrain.minutes) }} </span>
        </div>
        <div class="muted tiny" v-if="nextTrain && nextTrain.type === 'friday_only' && !isFriday">
          <span class="warn">Note:</span> This train is Friday-only; toggle “Treat today as Friday” to include it.
        </div>
        <div class="muted tiny" v-if="errors.length">
          <div class="err" v-for="(e,i) in errors" :key="i">• {{ e }}</div>
        </div>
      </div>

      <div class="card row">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
          <div>
            <b>Upcoming trains</b>
            <span class="muted tiny"> (showing next {{ upcomingLimit }})</span>
          </div>
          <div style="display:flex; gap:10px; align-items:center;">
            <label class="muted tiny" style="margin:0;">Show</label>
            <select v-model.number="upcomingLimit" style="width:110px;">
              <option :value="3">3</option>
              <option :value="5">5</option>
              <option :value="10">10</option>
            </select>
          </div>
        </div>

        <table v-if="upcoming.length">
          <thead>
            <tr>
              <th>Train</th>
              <th>Type</th>
              <th>Time at station</th>
              <th>In</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="t in upcoming" :key="t.train + t.time">
              <td><b>{{ t.train }}</b></td>
              <td>
                <span class="pill accent" v-if="t.type === 'express'">Express</span>
                <span class="pill" v-else-if="t.type === 'friday_only'">Friday-only</span>
                <span class="pill" v-else>Regular</span>
              </td>
              <td>{{ t.time }}</td>
              <td>{{ minutesUntil(t.minutes) }}</td>
            </tr>
          </tbody>
        </table>

        <div class="muted" v-else>
          No trains found for that station/day/direction at the selected time.
        </div>
      </div>
    </div>
  </div>

  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script>
    // =============================
    // 1) Paste your FULL JSON here
    // =============================
    const SCHEDULE = {
  "railroad": "New Mexico Rail Runner Express",
  "effective_date": "October 7, 2024",
  "stations": [
    "Belen",
    "Los Lunas",
    "Isleta Pueblo",
    "Bernalillo Co.",
    "Downtown ABQ",
    "Montaño",
    "Los Ranchos / JC",
    "Sandia Pueblo",
    "Downtown Bernalillo",
    "Sandoval Co. / US 550",
    "Kewa",
    "Santa Fe Co. / NM 599",
    "Zia Road",
    "South Capitol",
    "Santa Fe Depot"
  ],
  "weekday": {
    "northbound": {
      "trains": [
        {
          "train": "#502",
          "type": "regular",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "4:32A",
            "Montaño": "4:41A",
            "Los Ranchos / JC": "4:47A",
            "Sandia Pueblo": "4:52A",
            "Downtown Bernalillo": "5:01A",
            "Sandoval Co. / US 550": "5:05A",
            "Kewa": "5:25A",
            "Santa Fe Co. / NM 599": "5:48A",
            "Zia Road": "6:03A",
            "South Capitol": "6:13A",
            "Santa Fe Depot": "6:18A"
          }
        },
        {
          "train": "#504",
          "type": "regular",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "5:02A",
            "Montaño": "5:11A",
            "Los Ranchos / JC": "5:17A",
            "Sandia Pueblo": "5:22A",
            "Downtown Bernalillo": "5:31A",
            "Sandoval Co. / US 550": "5:35A",
            "Kewa": "5:55A",
            "Santa Fe Co. / NM 599": "6:18A",
            "Zia Road": "6:28A",
            "South Capitol": "6:38A",
            "Santa Fe Depot": "6:43A"
          }
        },
        {
          "train": "#102",
          "type": "express",
          "stops": {
            "Belen": "5:36A",
            "Los Lunas": "5:46A",
            "Isleta Pueblo": "5:59A",
            "Bernalillo Co.": "6:07A",
            "Downtown ABQ": "6:19A",
            "Montaño": "6:28A",
            "Los Ranchos / JC": "6:34A",
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": "6:46A",
            "Kewa": "7:05A",
            "Santa Fe Co. / NM 599": "7:25A",
            "Zia Road": null,
            "South Capitol": "7:43A",
            "Santa Fe Depot": "7:48A"
          }
        },
        {
          "train": "#506",
          "type": "regular",
          "stops": {
            "Belen": "6:35A",
            "Los Lunas": "6:46A",
            "Isleta Pueblo": "6:59A",
            "Bernalillo Co.": "7:06A",
            "Downtown ABQ": "7:19A",
            "Montaño": "7:29A",
            "Los Ranchos / JC": "7:36A",
            "Sandia Pueblo": "7:42A",
            "Downtown Bernalillo": "7:52A",
            "Sandoval Co. / US 550": "7:56A",
            "Kewa": "8:18A",
            "Santa Fe Co. / NM 599": "8:39A",
            "Zia Road": "8:49A",
            "South Capitol": "8:56A",
            "Santa Fe Depot": "9:01A"
          }
        },
        {
          "train": "#508",
          "type": "regular",
          "stops": {
            "Belen": "8:04A",
            "Los Lunas": "8:15A",
            "Isleta Pueblo": "8:27A",
            "Bernalillo Co.": "8:35A",
            "Downtown ABQ": "8:43A",
            "Montaño": null,
            "Los Ranchos / JC": null,
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": null,
            "Kewa": null,
            "Santa Fe Co. / NM 599": null,
            "Zia Road": null,
            "South Capitol": null,
            "Santa Fe Depot": null
          }
        },
        {
          "train": "#510",
          "type": "regular",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "9:35A",
            "Montaño": "9:44A",
            "Los Ranchos / JC": "9:50A",
            "Sandia Pueblo": "9:55A",
            "Downtown Bernalillo": "10:03A",
            "Sandoval Co. / US 550": "10:08A",
            "Kewa": "10:28A",
            "Santa Fe Co. / NM 599": "10:51A",
            "Zia Road": "11:01A",
            "South Capitol": "11:11A",
            "Santa Fe Depot": "11:16A"
          }
        },
        {
          "train": "#512",
          "type": "regular",
          "stops": {
            "Belen": "9:45A",
            "Los Lunas": "9:56A",
            "Isleta Pueblo": "10:08A",
            "Bernalillo Co.": "10:16A",
            "Downtown ABQ": "10:24A",
            "Montaño": null,
            "Los Ranchos / JC": null,
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": null,
            "Kewa": null,
            "Santa Fe Co. / NM 599": null,
            "Zia Road": null,
            "South Capitol": null,
            "Santa Fe Depot": null
          }
        },
        {
          "train": "#514",
          "type": "regular",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "12:24P",
            "Montaño": "12:33P",
            "Los Ranchos / JC": "12:39P",
            "Sandia Pueblo": "12:44P",
            "Downtown Bernalillo": "12:53P",
            "Sandoval Co. / US 550": "12:58P",
            "Kewa": "1:18P",
            "Santa Fe Co. / NM 599": "1:43P",
            "Zia Road": "1:54P",
            "South Capitol": "2:03P",
            "Santa Fe Depot": "2:08P"
          }
        },
        {
          "train": "#104",
          "type": "express",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "2:19P",
            "Montaño": "2:32P",
            "Los Ranchos / JC": "2:38P",
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": "2:49P",
            "Kewa": "3:09P",
            "Santa Fe Co. / NM 599": "3:29P",
            "Zia Road": null,
            "South Capitol": "3:47P",
            "Santa Fe Depot": "3:52P"
          }
        },
        {
          "train": "#516",
          "type": "regular",
          "stops": {
            "Belen": "3:35P",
            "Los Lunas": "3:46P",
            "Isleta Pueblo": "3:59P",
            "Bernalillo Co.": "4:06P",
            "Downtown ABQ": "4:26P",
            "Montaño": "4:35P",
            "Los Ranchos / JC": "4:41P",
            "Sandia Pueblo": "4:46P",
            "Downtown Bernalillo": "4:54P",
            "Sandoval Co. / US 550": "4:59P",
            "Kewa": "5:19P",
            "Santa Fe Co. / NM 599": "5:43P",
            "Zia Road": "5:55P",
            "South Capitol": "6:02P",
            "Santa Fe Depot": "6:07P"
          }
        },
        {
          "train": "#518",
          "type": "regular",
          "stops": {
            "Belen": null,
            "Los Lunas": null,
            "Isleta Pueblo": null,
            "Bernalillo Co.": null,
            "Downtown ABQ": "5:34P",
            "Montaño": "5:43P",
            "Los Ranchos / JC": "5:49P",
            "Sandia Pueblo": "5:54P",
            "Downtown Bernalillo": "6:07P",
            "Sandoval Co. / US 550": "6:12P",
            "Kewa": "6:34P",
            "Santa Fe Co. / NM 599": "6:57P",
            "Zia Road": "7:09P",
            "South Capitol": "7:19P",
            "Santa Fe Depot": "7:24P"
          }
        },
        {
          "train": "#520",
          "type": "regular",
          "stops": {
            "Belen": "5:51P",
            "Los Lunas": "6:01P",
            "Isleta Pueblo": "6:20P",
            "Bernalillo Co.": "6:29P",
            "Downtown ABQ": "6:48P",
            "Montaño": "6:58P",
            "Los Ranchos / JC": "7:06P",
            "Sandia Pueblo": "7:12P",
            "Downtown Bernalillo": "7:23P",
            "Sandoval Co. / US 550": "7:28P",
            "Kewa": "7:50P",
            "Santa Fe Co. / NM 599": "8:13P",
            "Zia Road": "8:23P",
            "South Capitol": "8:33P",
            "Santa Fe Depot": "8:38P"
          }
        },
        {
          "train": "#522",
          "type": "regular",
          "stops": {
            "Belen": "7:01P",
            "Los Lunas": "7:12P",
            "Isleta Pueblo": "7:33P",
            "Bernalillo Co.": "7:41P",
            "Downtown ABQ": "7:50P",
            "Montaño": null,
            "Los Ranchos / JC": null,
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": null,
            "Kewa": null,
            "Santa Fe Co. / NM 599": null,
            "Zia Road": null,
            "South Capitol": null,
            "Santa Fe Depot": null
          }
        },
        {
          "train": "#524",
          "type": "friday_only",
          "stops": {
            "Belen": "8:03P",
            "Los Lunas": "8:14P",
            "Isleta Pueblo": "8:28P",
            "Bernalillo Co.": "8:36P",
            "Downtown ABQ": "8:45P",
            "Montaño": null,
            "Los Ranchos / JC": null,
            "Sandia Pueblo": null,
            "Downtown Bernalillo": null,
            "Sandoval Co. / US 550": null,
            "Kewa": null,
            "Santa Fe Co. / NM 599": null,
            "Zia Road": null,
            "South Capitol": null,
            "Santa Fe Depot": null
          }
        }
      ]
    },
    "southbound": {
      "trains": [
        {
          "train": "#501",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": null,
            "South Capitol": null,
            "Zia Road": null,
            "Santa Fe Co. / NM 599": null,
            "Kewa": null,
            "Sandoval Co. / US 550": null,
            "Downtown Bernalillo": null,
            "Sandia Pueblo": null,
            "Los Ranchos / JC": null,
            "Montaño": null,
            "Downtown ABQ": "4:45A",
            "Bernalillo Co.": "4:54A",
            "Isleta Pueblo": "5:01A",
            "Los Lunas": "5:13A",
            "Belen": "5:24A"
          }
        },
        {
          "train": "#503",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": null,
            "South Capitol": null,
            "Zia Road": null,
            "Santa Fe Co. / NM 599": null,
            "Kewa": null,
            "Sandoval Co. / US 550": null,
            "Downtown Bernalillo": null,
            "Sandia Pueblo": null,
            "Los Ranchos / JC": null,
            "Montaño": null,
            "Downtown ABQ": "5:27A",
            "Bernalillo Co.": "5:38A",
            "Isleta Pueblo": "5:46A",
            "Los Lunas": "6:03A",
            "Belen": "6:14A"
          }
        },
        {
          "train": "#507",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "5:39A",
            "South Capitol": "5:44A",
            "Zia Road": "5:51A",
            "Santa Fe Co. / NM 599": "6:01A",
            "Kewa": "6:19A",
            "Sandoval Co. / US 550": "6:38A",
            "Downtown Bernalillo": "6:43A",
            "Sandia Pueblo": "6:52A",
            "Los Ranchos / JC": "6:57A",
            "Montaño": "7:02A",
            "Downtown ABQ": "7:10A",
            "Bernalillo Co.": "7:19A",
            "Isleta Pueblo": "7:27A",
            "Los Lunas": "7:39A",
            "Belen": "7:50A"
          }
        },
        {
          "train": "#509",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "7:08A",
            "South Capitol": "7:13A",
            "Zia Road": "7:20A",
            "Santa Fe Co. / NM 599": "7:37A",
            "Kewa": "7:55A",
            "Sandoval Co. / US 550": "8:14A",
            "Downtown Bernalillo": "8:18A",
            "Sandia Pueblo": "8:27A",
            "Los Ranchos / JC": "8:32A",
            "Montaño": "8:37A",
            "Downtown ABQ": "8:48A",
            "Bernalillo Co.": "8:57A",
            "Isleta Pueblo": "9:04A",
            "Los Lunas": "9:17A",
            "Belen": "9:29A"
          }
        },
        {
          "train": "#511",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "10:11A",
            "South Capitol": "10:17A",
            "Zia Road": "10:23A",
            "Santa Fe Co. / NM 599": "10:35A",
            "Kewa": "10:52A",
            "Sandoval Co. / US 550": "11:11A",
            "Downtown Bernalillo": "11:15A",
            "Sandia Pueblo": "11:24A",
            "Los Ranchos / JC": "11:29A",
            "Montaño": "11:35A",
            "Downtown ABQ": "11:44A",
            "Bernalillo Co.": null,
            "Isleta Pueblo": null,
            "Los Lunas": null,
            "Belen": null
          }
        },
        {
          "train": "#513",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "1:02P",
            "South Capitol": "1:07P",
            "Zia Road": "1:14P",
            "Santa Fe Co. / NM 599": "1:26P",
            "Kewa": "1:44P",
            "Sandoval Co. / US 550": "2:03P",
            "Downtown Bernalillo": "2:07P",
            "Sandia Pueblo": "2:16P",
            "Los Ranchos / JC": "2:21P",
            "Montaño": "2:26P",
            "Downtown ABQ": "2:42P",
            "Bernalillo Co.": "2:51P",
            "Isleta Pueblo": "2:58P",
            "Los Lunas": "3:11P",
            "Belen": "3:23P"
          }
        },
        {
          "train": "#515",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "2:46P",
            "South Capitol": "2:52P",
            "Zia Road": "3:00P",
            "Santa Fe Co. / NM 599": "3:11P",
            "Kewa": "3:34P",
            "Sandoval Co. / US 550": "3:54P",
            "Downtown Bernalillo": "3:58P",
            "Sandia Pueblo": "4:07P",
            "Los Ranchos / JC": "4:13P",
            "Montaño": "4:19P",
            "Downtown ABQ": "4:43P",
            "Bernalillo Co.": "4:52P",
            "Isleta Pueblo": "4:59P",
            "Los Lunas": "5:12P",
            "Belen": "5:24P"
          }
        },
        {
          "train": "#517",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "4:15P",
            "South Capitol": "4:20P",
            "Zia Road": "4:27P",
            "Santa Fe Co. / NM 599": "4:39P",
            "Kewa": "4:57P",
            "Sandoval Co. / US 550": "5:16P",
            "Downtown Bernalillo": "5:20P",
            "Sandia Pueblo": "5:29P",
            "Los Ranchos / JC": "5:34P",
            "Montaño": "5:39P",
            "Downtown ABQ": "5:50P",
            "Bernalillo Co.": "6:00P",
            "Isleta Pueblo": "6:07P",
            "Los Lunas": "6:23P",
            "Belen": "6:35P"
          }
        },
        {
          "train": "#101",
          "type": "express",
          "stops": {
            "Santa Fe Depot": "5:04P",
            "South Capitol": "5:09P",
            "Zia Road": null,
            "Santa Fe Co. / NM 599": "5:26P",
            "Kewa": null,
            "Sandoval Co. / US 550": "6:02P",
            "Downtown Bernalillo": null,
            "Sandia Pueblo": null,
            "Los Ranchos / JC": "6:16P",
            "Montaño": "6:21P",
            "Downtown ABQ": "6:32P",
            "Bernalillo Co.": null,
            "Isleta Pueblo": null,
            "Los Lunas": null,
            "Belen": null
          }
        },
        {
          "train": "#519",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "5:30P",
            "South Capitol": "5:35P",
            "Zia Road": "5:42P",
            "Santa Fe Co. / NM 599": "5:54P",
            "Kewa": "6:12P",
            "Sandoval Co. / US 550": "6:31P",
            "Downtown Bernalillo": "6:35P",
            "Sandia Pueblo": "6:44P",
            "Los Ranchos / JC": "6:49P",
            "Montaño": "6:54P",
            "Downtown ABQ": "7:03P",
            "Bernalillo Co.": "7:12P",
            "Isleta Pueblo": "7:20P",
            "Los Lunas": "7:34P",
            "Belen": "7:46P"
          }
        },
        {
          "train": "#521",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "6:46P",
            "South Capitol": "6:51P",
            "Zia Road": "6:58P",
            "Santa Fe Co. / NM 599": "7:10P",
            "Kewa": "7:28P",
            "Sandoval Co. / US 550": "7:47P",
            "Downtown Bernalillo": "7:51P",
            "Sandia Pueblo": "8:00P",
            "Los Ranchos / JC": "8:05P",
            "Montaño": "8:10P",
            "Downtown ABQ": "8:18P",
            "Bernalillo Co.": null,
            "Isleta Pueblo": null,
            "Los Lunas": null,
            "Belen": null
          }
        },
        {
          "train": "#523",
          "type": "regular",
          "stops": {
            "Santa Fe Depot": "9:00P",
            "South Capitol": "9:05P",
            "Zia Road": "9:12P",
            "Santa Fe Co. / NM 599": "9:24P",
            "Kewa": "9:42P",
            "Sandoval Co. / US 550": "10:01P",
            "Downtown Bernalillo": "10:05P",
            "Sandia Pueblo": "10:14P",
            "Los Ranchos / JC": "10:19P",
            "Montaño": "10:24P",
            "Downtown ABQ": "10:32P",
            "Bernalillo Co.": null,
            "Isleta Pueblo": null,
            "Los Lunas": null,
            "Belen": null
          }
        },
        {
          "train": "#525",
          "type": "friday_only",
          "stops": {
            "Santa Fe Depot": "10:05P",
            "South Capitol": "10:10P",
            "Zia Road": "10:17P",
            "Santa Fe Co. / NM 599": "10:29P",
            "Kewa": "10:47P",
            "Sandoval Co. / US 550": "11:06P",
            "Downtown Bernalillo": "11:10P",
            "Sandia Pueblo": "11:19P",
            "Los Ranchos / JC": "11:24P",
            "Montaño": "11:29P",
            "Downtown ABQ": "11:37P",
            "Bernalillo Co.": null,
            "Isleta Pueblo": null,
            "Los Lunas": null,
            "Belen": null
          }
        }
      ]
    }
  },
  "weekend": {
    "saturday": {
      "northbound": {
        "trains": [
          {
            "train": "#702",
            "stops": {
              "Belen": "7:24A",
              "Los Lunas": "7:34A",
              "Isleta Pueblo": "7:45A",
              "Bernalillo Co.": "7:53A",
              "Downtown ABQ": "8:04A",
              "Montaño": "8:13A",
              "Los Ranchos / JC": "8:19A",
              "Sandia Pueblo": "8:24A",
              "Downtown Bernalillo": "8:32A",
              "Sandoval Co. / US 550": "8:36A",
              "Kewa": "8:54A",
              "Santa Fe Co. / NM 599": "9:15A",
              "Zia Road": "9:26A",
              "South Capitol": "9:34A",
              "Santa Fe Depot": "9:39A"
            }
          },
          {
            "train": "#704",
            "stops": {
              "Belen": "9:20A",
              "Los Lunas": "9:30A",
              "Isleta Pueblo": "9:41A",
              "Bernalillo Co.": "9:49A",
              "Downtown ABQ": "10:08A",
              "Montaño": "10:17A",
              "Los Ranchos / JC": "10:23A",
              "Sandia Pueblo": "10:28A",
              "Downtown Bernalillo": "10:37A",
              "Sandoval Co. / US 550": "10:41A",
              "Kewa": "11:02A",
              "Santa Fe Co. / NM 599": "11:25A",
              "Zia Road": "11:36A",
              "South Capitol": "11:44A",
              "Santa Fe Depot": "11:50A"
            }
          },
          {
            "train": "#706",
            "stops": {
              "Belen": "12:30P",
              "Los Lunas": "12:40P",
              "Isleta Pueblo": "12:51P",
              "Bernalillo Co.": "12:59P",
              "Downtown ABQ": "1:14P",
              "Montaño": "1:23P",
              "Los Ranchos / JC": "1:29P",
              "Sandia Pueblo": "1:34P",
              "Downtown Bernalillo": "1:42P",
              "Sandoval Co. / US 550": "1:46P",
              "Kewa": "2:04P",
              "Santa Fe Co. / NM 599": "2:25P",
              "Zia Road": "2:36P",
              "South Capitol": "2:44P",
              "Santa Fe Depot": "2:49P"
            }
          },
          {
            "train": "#708",
            "stops": {
              "Belen": null,
              "Los Lunas": null,
              "Isleta Pueblo": null,
              "Bernalillo Co.": null,
              "Downtown ABQ": "3:11P",
              "Montaño": "3:20P",
              "Los Ranchos / JC": "3:26P",
              "Sandia Pueblo": "3:31P",
              "Downtown Bernalillo": "3:40P",
              "Sandoval Co. / US 550": "3:45P",
              "Kewa": "4:10P",
              "Santa Fe Co. / NM 599": "4:31P",
              "Zia Road": "4:42P",
              "South Capitol": "4:50P",
              "Santa Fe Depot": "4:56P"
            }
          },
          {
            "train": "#710",
            "stops": {
              "Belen": "5:40P",
              "Los Lunas": "5:50P",
              "Isleta Pueblo": "6:01P",
              "Bernalillo Co.": "6:09P",
              "Downtown ABQ": "6:20P",
              "Montaño": "6:29P",
              "Los Ranchos / JC": "6:35P",
              "Sandia Pueblo": "6:40P",
              "Downtown Bernalillo": "6:48P",
              "Sandoval Co. / US 550": "6:52P",
              "Kewa": "7:10P",
              "Santa Fe Co. / NM 599": "7:31P",
              "Zia Road": "7:42P",
              "South Capitol": "7:50P",
              "Santa Fe Depot": "7:55P"
            }
          },
          {
            "train": "#712",
            "stops": {
              "Belen": "7:43P",
              "Los Lunas": "7:53P",
              "Isleta Pueblo": "8:04P",
              "Bernalillo Co.": "8:12P",
              "Downtown ABQ": "8:23P",
              "Montaño": "8:32P",
              "Los Ranchos / JC": "8:38P",
              "Sandia Pueblo": "8:43P",
              "Downtown Bernalillo": "8:51P",
              "Sandoval Co. / US 550": "8:55P",
              "Kewa": null,
              "Santa Fe Co. / NM 599": "9:34P",
              "Zia Road": "9:45P",
              "South Capitol": "9:53P",
              "Santa Fe Depot": "9:58P"
            }
          },
          {
            "train": "#714",
            "stops": {
              "Belen": "10:40P",
              "Los Lunas": "10:50P",
              "Isleta Pueblo": "11:02P",
              "Bernalillo Co.": "11:08P",
              "Downtown ABQ": "11:16P",
              "Montaño": null,
              "Los Ranchos / JC": null,
              "Sandia Pueblo": null,
              "Downtown Bernalillo": null,
              "Sandoval Co. / US 550": null,
              "Kewa": null,
              "Santa Fe Co. / NM 599": null,
              "Zia Road": null,
              "South Capitol": null,
              "Santa Fe Depot": null
            }
          }
        ]
      },
      "southbound": {
        "trains": [
          {
            "train": "#703",
            "stops": {
              "Santa Fe Depot": null,
              "South Capitol": null,
              "Zia Road": null,
              "Santa Fe Co. / NM 599": null,
              "Kewa": null,
              "Sandoval Co. / US 550": null,
              "Downtown Bernalillo": null,
              "Sandia Pueblo": null,
              "Los Ranchos / JC": null,
              "Montaño": null,
              "Downtown ABQ": "8:21A",
              "Bernalillo Co.": "8:31A",
              "Isleta Pueblo": "8:39A",
              "Los Lunas": "8:50A",
              "Belen": "9:00A"
            }
          },
          {
            "train": "#705",
            "stops": {
              "Santa Fe Depot": "10:00A",
              "South Capitol": "10:05A",
              "Zia Road": null,
              "Santa Fe Co. / NM 599": "10:22A",
              "Kewa": "10:40A",
              "Sandoval Co. / US 550": "11:02A",
              "Downtown Bernalillo": "11:05A",
              "Sandia Pueblo": "11:14A",
              "Los Ranchos / JC": "11:19A",
              "Montaño": "11:25A",
              "Downtown ABQ": "11:35A",
              "Bernalillo Co.": "11:45A",
              "Isleta Pueblo": "11:53A",
              "Los Lunas": "12:04P",
              "Belen": "12:14P"
            }
          },
          {
            "train": "#707",
            "stops": {
              "Santa Fe Depot": "12:57P",
              "South Capitol": "1:03P",
              "Zia Road": null,
              "Santa Fe Co. / NM 599": "1:21P",
              "Kewa": "1:40P",
              "Sandoval Co. / US 550": "2:04P",
              "Downtown Bernalillo": "2:08P",
              "Sandia Pueblo": "2:17P",
              "Los Ranchos / JC": "2:23P",
              "Montaño": "2:28P",
              "Downtown ABQ": "2:38P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          },
          {
            "train": "#709",
            "stops": {
              "Santa Fe Depot": "3:05P",
              "South Capitol": "3:10P",
              "Zia Road": "3:18P",
              "Santa Fe Co. / NM 599": "3:27P",
              "Kewa": "3:45P",
              "Sandoval Co. / US 550": "4:03P",
              "Downtown Bernalillo": "4:06P",
              "Sandia Pueblo": "4:17P",
              "Los Ranchos / JC": "4:20P",
              "Montaño": "4:26P",
              "Downtown ABQ": "4:36P",
              "Bernalillo Co.": "4:50P",
              "Isleta Pueblo": "5:10P",
              "Los Lunas": "5:20P",
              "Belen": "5:30P"
            }
          },
          {
            "train": "#711",
            "stops": {
              "Santa Fe Depot": "5:55P",
              "South Capitol": "6:09P",
              "Zia Road": "6:17P",
              "Santa Fe Co. / NM 599": "6:27P",
              "Kewa": "6:46P",
              "Sandoval Co. / US 550": "7:10P",
              "Downtown Bernalillo": "7:14P",
              "Sandia Pueblo": "7:23P",
              "Los Ranchos / JC": "7:28P",
              "Montaño": "7:34P",
              "Downtown ABQ": "7:44P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          },
          {
            "train": "#713",
            "stops": {
              "Santa Fe Depot": "6:03P",
              "South Capitol": "6:09P",
              "Zia Road": "6:17P",
              "Santa Fe Co. / NM 599": "6:27P",
              "Kewa": "6:46P",
              "Sandoval Co. / US 550": "7:10P",
              "Downtown Bernalillo": "7:14P",
              "Sandia Pueblo": "7:23P",
              "Los Ranchos / JC": "7:28P",
              "Montaño": "7:34P",
              "Downtown ABQ": "7:44P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          },
          {
            "train": "#715",
            "stops": {
              "Santa Fe Depot": "8:10P",
              "South Capitol": "8:15P",
              "Zia Road": "8:23P",
              "Santa Fe Co. / NM 599": "8:32P",
              "Kewa": "8:50P",
              "Sandoval Co. / US 550": "9:11P",
              "Downtown Bernalillo": "9:16P",
              "Sandia Pueblo": "9:25P",
              "Los Ranchos / JC": "9:30P",
              "Montaño": "9:36P",
              "Downtown ABQ": "9:46P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          },
          {
            "train": "#717",
            "stops": {
              "Santa Fe Depot": "10:14P",
              "South Capitol": "10:19P",
              "Zia Road": "10:27P",
              "Santa Fe Co. / NM 599": "10:36P",
              "Kewa": "10:54P",
              "Sandoval Co. / US 550": "11:13P",
              "Downtown Bernalillo": "11:16P",
              "Sandia Pueblo": null,
              "Los Ranchos / JC": null,
              "Montaño": "11:36P",
              "Downtown ABQ": "11:45P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": "10:25P",
              "Belen": null
            }
          }
        ]
      }
    },
    "sunday": {
      "northbound": {
        "trains": [
          {
            "train": "#702",
            "stops": {
              "Belen": "7:24A",
              "Los Lunas": "7:34A",
              "Isleta Pueblo": "7:45A",
              "Bernalillo Co.": "7:53A",
              "Downtown ABQ": "8:04A",
              "Montaño": "8:13A",
              "Los Ranchos / JC": "8:19A",
              "Sandia Pueblo": "8:24A",
              "Downtown Bernalillo": "8:32A",
              "Sandoval Co. / US 550": "8:36A",
              "Kewa": "8:54A",
              "Santa Fe Co. / NM 599": "9:15A",
              "Zia Road": "9:26A",
              "South Capitol": "9:34A",
              "Santa Fe Depot": "9:39A"
            }
          },
          {
            "train": "#706",
            "stops": {
              "Belen": "12:30P",
              "Los Lunas": "12:40P",
              "Isleta Pueblo": "12:51P",
              "Bernalillo Co.": "12:59P",
              "Downtown ABQ": "1:14P",
              "Montaño": "1:23P",
              "Los Ranchos / JC": "1:29P",
              "Sandia Pueblo": "1:34P",
              "Downtown Bernalillo": "1:42P",
              "Sandoval Co. / US 550": "1:46P",
              "Kewa": "2:04P",
              "Santa Fe Co. / NM 599": "2:25P",
              "Zia Road": "2:36P",
              "South Capitol": "2:44P",
              "Santa Fe Depot": "2:49P"
            }
          },
          {
            "train": "#708",
            "stops": {
              "Belen": null,
              "Los Lunas": null,
              "Isleta Pueblo": null,
              "Bernalillo Co.": null,
              "Downtown ABQ": "3:11P",
              "Montaño": "3:20P",
              "Los Ranchos / JC": "3:26P",
              "Sandia Pueblo": "3:31P",
              "Downtown Bernalillo": "3:40P",
              "Sandoval Co. / US 550": "3:45P",
              "Kewa": "4:10P",
              "Santa Fe Co. / NM 599": "4:31P",
              "Zia Road": "4:42P",
              "South Capitol": "4:50P",
              "Santa Fe Depot": "4:56P"
            }
          },
          {
            "train": "#710",
            "stops": {
              "Belen": "5:40P",
              "Los Lunas": null,
              "Isleta Pueblo": "6:01P",
              "Bernalillo Co.": "6:09P",
              "Downtown ABQ": "6:20P",
              "Montaño": "6:29P",
              "Los Ranchos / JC": "6:35P",
              "Sandia Pueblo": "6:40P",
              "Downtown Bernalillo": "6:48P",
              "Sandoval Co. / US 550": "6:52P",
              "Kewa": "7:10P",
              "Santa Fe Co. / NM 599": "7:31P",
              "Zia Road": "7:42P",
              "South Capitol": "7:50P",
              "Santa Fe Depot": "7:55P"
            }
          }
        ]
      },
      "southbound": {
        "trains": [
          {
            "train": "#701",
            "stops": {
              "Santa Fe Depot": null,
              "South Capitol": null,
              "Zia Road": null,
              "Santa Fe Co. / NM 599": null,
              "Kewa": null,
              "Sandoval Co. / US 550": null,
              "Downtown Bernalillo": null,
              "Sandia Pueblo": null,
              "Los Ranchos / JC": null,
              "Montaño": null,
              "Downtown ABQ": "6:30A",
              "Bernalillo Co.": "6:40A",
              "Isleta Pueblo": "6:48A",
              "Los Lunas": "6:59A",
              "Belen": "7:09A"
            }
          },
          {
            "train": "#705",
            "stops": {
              "Santa Fe Depot": "10:00A",
              "South Capitol": "10:05A",
              "Zia Road": "10:13A",
              "Santa Fe Co. / NM 599": "10:22A",
              "Kewa": "10:40A",
              "Sandoval Co. / US 550": "11:02A",
              "Downtown Bernalillo": "11:05A",
              "Sandia Pueblo": "11:14A",
              "Los Ranchos / JC": "11:19A",
              "Montaño": "11:25A",
              "Downtown ABQ": "11:35A",
              "Bernalillo Co.": "11:45A",
              "Isleta Pueblo": "11:53A",
              "Los Lunas": "12:04P",
              "Belen": "12:14P"
            }
          },
          {
            "train": "#709",
            "stops": {
              "Santa Fe Depot": "3:05P",
              "South Capitol": "3:10P",
              "Zia Road": "3:18P",
              "Santa Fe Co. / NM 599": "3:27P",
              "Kewa": "3:45P",
              "Sandoval Co. / US 550": "4:03P",
              "Downtown Bernalillo": "4:06P",
              "Sandia Pueblo": "4:17P",
              "Los Ranchos / JC": "4:20P",
              "Montaño": "4:26P",
              "Downtown ABQ": "4:39P",
              "Bernalillo Co.": "4:50P",
              "Isleta Pueblo": "5:10P",
              "Los Lunas": "5:20P",
              "Belen": "5:30P"
            }
          },
          {
            "train": "#713",
            "stops": {
              "Santa Fe Depot": "8:10P",
              "South Capitol": "8:15P",
              "Zia Road": "8:23P",
              "Santa Fe Co. / NM 599": "8:32P",
              "Kewa": "8:50P",
              "Sandoval Co. / US 550": "9:11P",
              "Downtown Bernalillo": "9:16P",
              "Sandia Pueblo": "9:25P",
              "Los Ranchos / JC": "9:30P",
              "Montaño": "9:36P",
              "Downtown ABQ": "9:46P",
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          },
          {
            "train": "#719",
            "stops": {
              "Santa Fe Depot": "8:10P",
              "South Capitol": "8:15P",
              "Zia Road": "8:23P",
              "Santa Fe Co. / NM 599": "8:32P",
              "Kewa": "8:50P",
              "Sandoval Co. / US 550": "9:11P",
              "Downtown Bernalillo": "9:11P",
              "Sandia Pueblo": null,
              "Los Ranchos / JC": null,
              "Montaño": null,
              "Downtown ABQ": null,
              "Bernalillo Co.": null,
              "Isleta Pueblo": null,
              "Los Lunas": null,
              "Belen": null
            }
          }
        ]
      }
    }
  },
  "legend": {
    "dashes": "Train does not stop at this station",
    "underlined_time": "Train arrives and does not continue",
    "shaded_row": "Express train",
    "dotted_border": "Friday train only"
  },
  "notes": {
    "null_values": "null indicates the train does not stop at or serve this station",
    "time_format": "Times use A (AM) and P (PM) suffixes",
    "effective_date": "Schedule effective October 7, 2024"
  }
};

    // --- time parsing helpers: "7:24A" / "12:03P" => minutes since midnight
    function parseRailTime(t) {
      if (!t || typeof t !== "string") return null;
      const m = t.match(/^(\d{1,2}):(\d{2})([AP])$/i);
      if (!m) return null;
      let hh = parseInt(m[1], 10);
      const mm = parseInt(m[2], 10);
      const ap = m[3].toUpperCase();
      if (hh === 12) hh = 0; // 12:xxA => 0:xx ; 12:xxP => 12:xx
      let mins = hh * 60 + mm;
      if (ap === "P") mins += 12 * 60;
      return mins;
    }

    function hhmmToMinutes(hhmm) {
      const [h, m] = hhmm.split(":").map(x => parseInt(x, 10));
      if (Number.isNaN(h) || Number.isNaN(m)) return null;
      return h * 60 + m;
    }

    function getActiveDayKey(dayMode) {
      const d = new Date();
      const dow = d.getDay(); // 0 Sun .. 6 Sat
      if (dayMode === "weekday") return "weekday";
      if (dayMode === "saturday") return "saturday";
      if (dayMode === "sunday") return "sunday";
      // auto:
      if (dow === 6) return "saturday";
      if (dow === 0) return "sunday";
      return "weekday";
    }

    function extractTrains(schedule, dayKey, direction) {
      if (dayKey === "weekday") {
        const node = schedule.weekday?.[direction];
        return node?.trains ?? [];
      }
      const node = schedule.weekend?.[dayKey]?.[direction];
      return node?.trains ?? [];
    }

    const { createApp } = Vue;

    createApp({
      data() {
        return {
          dayMode: "auto",
          isFriday: false,
          direction: "northbound",
          station: (SCHEDULE.stations && SCHEDULE.stations[0]) || "Downtown ABQ",
          timeHHMM: "07:00",
          upcomingLimit: 5,
          errors: []
        };
      },
      computed: {
        stations() {
          return SCHEDULE.stations || [];
        },
        activeDayKey() {
          return getActiveDayKey(this.dayMode);
        },
        activeDayLabel() {
          return this.activeDayKey === "weekday" ? "Weekday" :
                 this.activeDayKey === "saturday" ? "Saturday" : "Sunday";
        },
        directionLabel() {
          return this.direction === "northbound" ? "Northbound" : "Southbound";
        },
        trainsForSelection() {
          return extractTrains(SCHEDULE, this.activeDayKey, this.direction);
        },
        nowMinutes() {
          return hhmmToMinutes(this.timeHHMM);
        },
        upcomingAll() {
          this.errors = [];
          const nowM = this.nowMinutes;
          if (nowM == null) {
            this.errors.push("Invalid current time.");
            return [];
          }
          if (!this.station) {
            this.errors.push("Pick a station.");
            return [];
          }

          const rows = [];
          for (const tr of this.trainsForSelection) {
            const t = tr?.stops?.[this.station] ?? null;

            // Honor Friday-only
            if (tr.type === "friday_only" && !this.isFriday) continue;

            const mins = parseRailTime(t);
            if (mins == null) continue;

            // upcoming only (same-day, no overnight wrap logic here)
            if (mins >= nowM) {
              rows.push({
                train: tr.train,
                type: tr.type || "regular",
                time: t,
                minutes: mins - nowM
              });
            }
          }
          rows.sort((a,b) => a.minutes - b.minutes);
          return rows;
        },
        upcoming() {
          return this.upcomingAll.slice(0, this.upcomingLimit);
        },
        nextTrain() {
          return this.upcomingAll.length ? this.upcomingAll[0] : null;
        }
      },
      methods: {
        setNow() {
          const d = new Date();
          const hh = String(d.getHours()).padStart(2, "0");
          const mm = String(d.getMinutes()).padStart(2, "0");
          this.timeHHMM = `${hh}:${mm}`;
          this.isFriday = (d.getDay() === 5); // 5 = Friday
        },
        minutesUntil(deltaMins) {
          if (deltaMins == null) return "";
          if (deltaMins === 0) return "now";
          if (deltaMins < 60) return `${deltaMins} min`;
          const h = Math.floor(deltaMins / 60);
          const m = deltaMins % 60;
          return `${h}h ${m}m`;
        }
      },
      mounted() {
        this.setNow();
      }
    }).mount("#app");
  </script>
</body>
</html>